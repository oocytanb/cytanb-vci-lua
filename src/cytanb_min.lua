--! SPDX-License-Identifier: MIT
--! Copyright (c) 2019 oO (https://github.com/oocytanb)
---@type cytanb @Final Version. See `cytanb_annotations.lua`
local cytanb=(function()local a=function(_ENV)if not require or not vci then error('Invalid _ENV: Enable `__CYTANB_EXPORT_MODULE = true` line and pass valid _ENV of VCI-main if use cytanb.lua as module.',3)end;local b;local c;local d;local e;local f;local g;local h;local i;local j;local k;local l=false;local m;local n=''local o;local p=function(q,r)local s=q+r-1;return q,s,s+1 end;local t=function(q,r)local s=q-r+1;return s,q,s-1 end;local u=function(v,w,x,q,y)local z=x.searchMap;for A,r in pairs(x.lengthList)do if r<=0 then error('SearchPattern: Invalid parameter: searchLen <= 0')else local B,C,s=y(q,r)if B>=1 and C<=w then local D=string.sub(v,B,C)if z[D]then return true,r,s end end end end;return false,-1,-1 end;local E=function(v,x,q,y)if v==nil or x==nil then return false,-1 end;if x.hasEmptySearch then return true,0 end;local w=string.len(v)local F=x.repeatMin;local G=x.repeatMax;local H=G<0;local I=q;local J=0;local K=0;while H or K<G do local L,M,s=u(v,w,x,I,y)if L then if M<=0 then error('SearchPattern: Invalid parameter')end;I=s;J=J+M;K=K+1 else break end end;if K>=F then return true,J else return false,-1 end end;local N=function(v,O,q,P,y,Q)if v==nil or O==nil then return false,-1 end;local r=string.len(O)if P then local L=Q(v,O)return L,L and r or-1 else if r==0 then return true,r end;local w=string.len(v)local B,C=y(q,r)if B>=1 and C<=w then local D=string.sub(v,B,C)local L=Q(D,O)return L,L and r or-1 else return false,-1 end end end;local R=function(v,S,T)if S<=T then local U=string.unicode(v,S,S)if U>=0xDC00 or U<=0xDFFF then return true,1,U end end;return false,-1,nil end;local V=function(v,S,T,W)if S<=T then local X,Y=o.StringStartsWith(v,c,S)if X then local Z=S+Y;if Z<=T then local _,a0=o.StringStartsWith(v,d,Z)if _ then local a1=Z+a0;if a1<=T and string.unicode(v,a1,a1)==0x3E then local a2=tonumber(string.sub(v,Z,Z+a0-1))if a2<=W then return true,a1-S+1,a2 end end end end end end;return false,-1,nil end;local a3=function(a4,a5)for a6=1,4 do local a7=a4[a6]-a5[a6]if a7~=0 then return a7 end end;return 0 end;local a8;a8={__eq=function(a4,a5)return a4[1]==a5[1]and a4[2]==a5[2]and a4[3]==a5[3]and a4[4]==a5[4]end,__lt=function(a4,a5)return a3(a4,a5)<0 end,__le=function(a4,a5)return a3(a4,a5)<=0 end,__tostring=function(a9)local aa=a9[2]or 0;local ab=a9[3]or 0;return string.format('%08x-%04x-%04x-%04x-%04x%08x',bit32.band(a9[1]or 0,0xFFFFFFFF),bit32.band(bit32.rshift(aa,16),0xFFFF),bit32.band(aa,0xFFFF),bit32.band(bit32.rshift(ab,16),0xFFFF),bit32.band(ab,0xFFFF),bit32.band(a9[4]or 0,0xFFFFFFFF))end,__concat=function(a4,a5)local ac=getmetatable(a4)local ad=ac==a8 or type(ac)=='table'and ac.__concat==a8.__concat;local ae=getmetatable(a5)local af=ae==a8 or type(ae)=='table'and ae.__concat==a8.__concat;if not ad and not af then error('UUID: attempt to concatenate illegal values',2)end;return(ad and a8.__tostring(a4)or a4)..(af and a8.__tostring(a5)or a5)end}local ag='__CYTANB_CONST_VARIABLES'local ah=function(table,ai)local aj=getmetatable(table)if aj then local ak=rawget(aj,ag)if ak then local al=rawget(ak,ai)if type(al)=='function'then return al(table,ai)else return al end end end;return nil end;local am=function(table,ai,an)local aj=getmetatable(table)if aj then local ak=rawget(aj,ag)if ak then if rawget(ak,ai)~=nil then error('Cannot assign to read only field "'..ai..'"',2)end end end;rawset(table,ai,an)end;local ao=function(ap,aq)if not ap then return false,false end;local ar=ap[o.TypeParameterName]if o.NillableHasValue(ar)and o.NillableValue(ar)~=aq then return false,false end;return o.NillableIfHasValueOrElse(i[aq],function(as)local at=as.compositionFieldNames;local au=as.compositionFieldLength;local av=false;for aw,an in pairs(ap)do if at[aw]then au=au-1;if au<=0 and av then break end elseif aw~=o.TypeParameterName then av=true;if au<=0 then break end end end;return au<=0,av end,function()return false,false end)end;local ax=function(v)return o.StringReplace(o.StringReplace(v,o.EscapeSequenceTag,o.EscapeSequenceTag..o.EscapeSequenceTag),'/',o.SolidusTag)end;local ay=function(v,az)local aA=string.len(v)local aB=string.len(o.EscapeSequenceTag)if aB>aA then return v end;local aC=''local a6=1;while a6<aA do local C,aD=string.find(v,o.EscapeSequenceTag,a6,true)if not C then if a6==1 then aC=v else aC=aC..string.sub(v,a6)end;break end;if C>a6 then aC=aC..string.sub(v,a6,C-1)end;local aE=false;for aF,aG in ipairs(h)do local L=o.StringStartsWith(v,aG.search,C)if L then aC=aC..(az and az(aG.tag)or aG.replacement)a6=C+string.len(aG.search)aE=true;break end end;if not aE then aC=aC..o.EscapeSequenceTag;a6=aD+1 end end;return aC end;local aH;aH=function(aI,aJ)if type(aI)~='table'then return aI end;if not aJ then aJ={}end;if aJ[aI]then error('circular reference')end;aJ[aI]=true;local aK={}for aw,an in pairs(aI)do local aL=type(aw)local aM;if aL=='string'then aM=ax(aw)elseif aL=='number'then aM=tostring(aw)..o.ArrayNumberTag else aM=aw end;local aN=type(an)if aN=='string'then aK[aM]=ax(an)elseif aN=='number'and an<0 then aK[tostring(aM)..o.NegativeNumberTag]=tostring(an)else aK[aM]=aH(an,aJ)end end;aJ[aI]=nil;return aK end;local aO;aO=function(aK,aP)if type(aK)~='table'then return aK end;local aI={}for aw,an in pairs(aK)do local aM;local aQ=false;if type(aw)=='string'then local aR=false;aM=ay(aw,function(aS)if aS==o.NegativeNumberTag then aQ=true elseif aS==o.ArrayNumberTag then aR=true end;return nil end)if aR then aM=tonumber(aM)or aM end else aM=aw;aQ=false end;if aQ and type(an)=='string'then aI[aM]=tonumber(an)elseif type(an)=='string'then aI[aM]=ay(an,function(aS)return j[aS]end)else aI[aM]=aO(an,aP)end end;if not aP then o.NillableIfHasValue(aI[o.TypeParameterName],function(aT)o.NillableIfHasValue(i[aT],function(as)local aU,av=as.fromTableFunc(aI)if not av then o.NillableIfHasValue(aU,function(a9)aI=a9 end)end end)end)end;return aI end;local aV={['nil']=function(aW)return nil end,['number']=function(aW)return tonumber(aW)end,['string']=function(aW)return tostring(aW)end,['boolean']=function(aW)if aW then return true else return false end end}local aX=function(aW,aY)local aZ=type(aW)if aZ==aY then return aW else local a_=aV[aY]if a_ then return a_(aW)else return nil end end end;local b0=function(b1,b2)if b2 and type(b2)=='table'then local b3={}for ai,aW in pairs(b1)do local b4=b2[ai]local b5;if b4==nil then b5=aW else local b6=aX(b4,type(aW))if b6==nil then b5=aW else b5=b6 end end;b3[ai]=b5 end;b3[o.MessageOriginalSender]=b1;return b3 else return b1 end end;local b7=function(b8)local aK=o.NillableIfHasValueOrElse(b8,function(aI)if type(aI)~='table'then error('MakeMessageData: Invalid argument: table expected',4)end;return o.TableToSerializable(aI)end,function()return{}end)local b9=o.InstanceID()if b9==''then o.LogWarn('MakeMessageData: InstanceID is empty.')end;aK[o.InstanceIDParameterName]=b9;return json.serialize(aK)end;local ba=function(bb,bc,b2,bd)local be={type=bd,name='',commentSource=''}local b8={[o.MessageValueParameterName]=tostring(bc),[o.MessageSenderOverride]=type(b2)=='table'and o.Extend(be,b2,true)or be}o.EmitMessage(bb,b8)end;local bf=function(bb,bg,bh)local bi,bj=(function()local a_=function(b1,bk,b8)local bc=tostring(b8[o.MessageValueParameterName]or'')bh(b1,bg,bc)end;local bi=o.OnMessage(bb,a_)local bj=o.OnMessage(bg,a_)return bi,bj end)()return{Off=function()bi.Off()bj.Off()end}end;o={InstanceID=function()return vci.assets.GetInstanceId()or''end,OwnID=function()if n==''then local bl=vci.studio.GetLocalAvatar()if bl then n=bl.GetId()or''end end;return n end,ClientID=function()return o.OwnID()end,NillableHasValue=function(bm)return bm~=nil end,NillableValue=function(bm)if bm==nil then error('nillable: value is nil',2)end;return bm end,NillableValueOrDefault=function(bm,bn)if bm==nil then if bn==nil then error('nillable: defaultValue is nil',2)end;return bn else return bm end end,NillableIfHasValue=function(bm,bh)if bm==nil then return nil else return bh(bm)end end,NillableIfHasValueOrElse=function(bm,bh,bo)if bm==nil then return bo()else return bh(bm)end end,MakeSearchPattern=function(bp,bq,br)local F=bq and math.floor(bq)or 1;if F<0 then error('SearchPattern: Invalid parameter: optRepeatMin < 0')end;local G=br and math.floor(br)or F;if G>=0 and G<F then error('SearchPattern: Invalid parameter: repeatMax < repeatMin')end;local bs=G==0;local z={}local bt={}local bu={}local bv=0;for bw,bx in pairs(bp)do local r=string.len(bx)if r==0 then bs=true else z[bx]=r;if not bt[r]then bt[r]=true;bv=bv+1;bu[bv]=r end end end;table.sort(bu,function(by,L)return by>L end)return{hasEmptySearch=bs,searchMap=z,lengthList=bu,repeatMin=F,repeatMax=G}end,StringStartsWith=function(v,O,bz)local I=bz and math.max(1,math.floor(bz))or 1;if type(O)=='table'then return E(v,O,I,p)else return N(v,O,I,I==1,p,string.startsWith)end end,StringEndsWith=function(v,O,bA)if v==nil then return false,-1 end;local w=string.len(v)local I=bA and math.min(w,math.floor(bA))or w;if type(O)=='table'then return E(v,O,I,t)else return N(v,O,I,I==w,t,string.endsWith)end end,StringTrimStart=function(v,bB)if v==nil or v==''then return v end;local L,M=o.StringStartsWith(v,bB or b)if L and M>=1 then return string.sub(v,M+1)else return v end end,StringTrimEnd=function(v,bB)if v==nil or v==''then return v end;local L,M=o.StringEndsWith(v,bB or b)if L and M>=1 then return string.sub(v,1,string.len(v)-M)else return v end end,StringTrim=function(v,bB)return o.StringTrimEnd(o.StringTrimStart(v,bB),bB)end,StringReplace=function(v,bC,bD)local bE;local aA=string.len(v)if bC==''then bE=bD;for a6=1,aA do bE=bE..string.sub(v,a6,a6)..bD end else bE=''local a6=1;while true do local B,C=string.find(v,bC,a6,true)if B then bE=bE..string.sub(v,a6,B-1)..bD;a6=C+1;if a6>aA then break end else bE=a6==1 and v or bE..string.sub(v,a6)break end end end;return bE end,
StringEachCode=function(v,bh,bF,a6,bG,bH,bI,bJ)local aA=string.len(v)if aA==0 then return 0,0,0 end;local bK=a6 and math.floor(a6)or 1;local T=bG and math.floor(bG)or aA;local W=math.min(bJ or 3182,0x1FFFFF)if bK<=0 or T>aA or bK>T then error('StringEachCode: invalid range')end;local bL=0;local bM=bK;local bN=bM;while bM<=T do local B=bM;local U=string.unicode(v,bM,bM)if U>=0xD800 and U<=0xDBFF then local L,M=R(v,bM+1,T)if L then bM=bM+M end elseif bH and U==0x3C then local L,M,a2=V(v,bM+1,T,W)if L and(not bI or bI(a2))then bM=bM+M end end;bL=bL+1;bN=bM;if bh and bh(string.sub(v,B,bM),bL,bF,B,bM)==false then break end;bM=bM+1 end;return bL,bK,bN end,SetConst=function(bC,bb,a9)if type(bC)~='table'then error('Cannot set const to non-table target',2)end;local bO=getmetatable(bC)local aj=bO or{}local bP=rawget(aj,ag)if rawget(bC,bb)~=nil then error('Non-const field "'..bb..'" already exists',2)end;if not bP then bP={}rawset(aj,ag,bP)aj.__index=ah;aj.__newindex=am end;rawset(bP,bb,a9)if not bO then setmetatable(bC,aj)end;return bC end,SetConstEach=function(bC,bQ)for aw,an in pairs(bQ)do o.SetConst(bC,aw,an)end;return bC end,Extend=function(bC,bR,bS,bT,aJ)if bC==bR or type(bC)~='table'or type(bR)~='table'then return bC end;if bS then if not aJ then aJ={}end;if aJ[bR]then error('circular reference')end;aJ[bR]=true end;for aw,an in pairs(bR)do if bS and type(an)=='table'then local bU=bC[aw]bC[aw]=o.Extend(type(bU)=='table'and bU or{},an,bS,bT,aJ)else bC[aw]=an end end;if not bT then local bV=getmetatable(bR)if type(bV)=='table'then if bS then local bW=getmetatable(bC)setmetatable(bC,o.Extend(type(bW)=='table'and bW or{},bV,true))else setmetatable(bC,bV)end end end;if bS then aJ[bR]=nil end;return bC end,Vars=function(an,bX,bY,aJ)local bZ;if bX then bZ=bX~='__NOLF'else bX='  'bZ=true end;if not bY then bY=''end;if not aJ then aJ={}end;local b_=type(an)if b_=='table'then aJ[an]=aJ[an]and aJ[an]+1 or 1;local c0=bZ and bY..bX or''local v='('..tostring(an)..') {'local c1=true;for ai,aW in pairs(an)do if c1 then c1=false else v=v..(bZ and','or', ')end;if bZ then v=v..'\n'..c0 end;local c2=type(ai)local c3=(c2=='function'or c2=='thread'or c2=='userdata'or c2=='table')and'('..c2 ..')'or tostring(ai)if type(aW)=='table'and aJ[aW]and aJ[aW]>0 then v=v..c3 ..' = ('..tostring(aW)..')'else v=v..c3 ..' = '..o.Vars(aW,bX,c0,aJ)end end;if not c1 and bZ then v=v..'\n'..bY end;v=v..'}'aJ[an]=aJ[an]-1;if aJ[an]<=0 then aJ[an]=nil end;return v elseif b_=='function'or b_=='thread'or b_=='userdata'then return'('..b_..')'elseif b_=='string'then return'('..b_..') '..string.format('%q',an)else return'('..b_..') '..tostring(an)end end,PosixTime=(function()local c4=os.time({year=1970,month=1,day=2,hour=0,min=0,sec=0,isdst=false})if not c4 then error('unexpected')end;local c5=os.date('!*t',c4)local c6=(((c5.day-1)*24+c5.hour)*60+c5.min)*60+c5.sec;return function(c7)return os.difftime(c7 or os.time(),c4)+c6 end end)(),GetLogLevel=function()return k end,SetLogLevel=function(c8)k=c8 end,IsOutputLogLevelEnabled=function()return l end,SetOutputLogLevelEnabled=function(c9)l=not not c9 end,Log=function(c8,...)if c8<=k then local ca=l and(m[c8]or'LOG LEVEL '..tostring(c8))..' | 'or''local cb=table.pack(...)if cb.n==1 then local an=cb[1]if an~=nil then local v=type(an)=='table'and o.Vars(an)or tostring(an)print(l and ca..v or v)else print(ca)end else local v=ca;for a6=1,cb.n do local an=cb[a6]if an~=nil then v=v..(type(an)=='table'and o.Vars(an)or tostring(an))end end;print(v)end end end,LogFatal=function(...)o.Log(o.LogLevelFatal,...)end,LogError=function(...)o.Log(o.LogLevelError,...)end,LogWarn=function(...)o.Log(o.LogLevelWarn,...)end,LogInfo=function(...)o.Log(o.LogLevelInfo,...)end,LogDebug=function(...)o.Log(o.LogLevelDebug,...)end,LogTrace=function(...)o.Log(o.LogLevelTrace,...)end,FatalLog=function(...)o.LogFatal(...)end,ErrorLog=function(...)o.LogError(...)end,WarnLog=function(...)o.LogWarn(...)end,InfoLog=function(...)o.LogInfo(...)end,DebugLog=function(...)o.LogDebug(...)end,TraceLog=function(...)o.LogTrace(...)end,ListToMap=function(cc,cd)local ce={}if cd==nil then for aw,an in pairs(cc)do ce[an]=an end elseif type(cd)=='function'then for aw,an in pairs(cc)do local cf,cg=cd(an)ce[cf]=cg end else for aw,an in pairs(cc)do ce[an]=cd end end;return ce end,Round=function(ch,ci)if ci then local cj=10^ci;return math.floor(ch*cj+0.5)/cj else return math.floor(ch+0.5)end end,Clamp=function(a9,ck,cl)return math.max(ck,math.min(a9,cl))end,Lerp=function(by,L,b_)if b_<=0.0 then return by elseif b_>=1.0 then return L else return by+(L-by)*b_ end end,LerpUnclamped=function(by,L,b_)if b_==0.0 then return by elseif b_==1.0 then return L else return by+(L-by)*b_ end end,PingPong=function(b_,cm)if cm==0 then return 0,1 end;local cn=math.floor(b_/cm)local co=b_-cn*cm;if cn<0 then if(cn+1)%2==0 then return cm-co,-1 else return co,1 end else if cn%2==0 then return co,1 else return cm-co,-1 end end end,VectorApproximatelyEquals=function(cp,cq)return(cp-cq).sqrMagnitude<1E-10 end,QuaternionApproximatelyEquals=function(cp,cq)local cr=Quaternion.Dot(cp,cq)return cr<1.0+1E-06 and cr>1.0-1E-06 end,QuaternionToAngleAxis=function(cs)local cn=cs.normalized;local ct=math.acos(cn.w)local cu=math.sin(ct)local cv=math.deg(ct*2.0)local cw;if math.abs(cu)<=Quaternion.kEpsilon then cw=Vector3.right else local B=1.0/cu;cw=Vector3.__new(cn.x*B,cn.y*B,cn.z*B)end;return cv,cw end,QuaternionTwist=function(cs,cx)if cx.sqrMagnitude<Vector3.kEpsilonNormalSqrt then return Quaternion.identity end;local cy=Vector3.__new(cs.x,cs.y,cs.z)if cy.sqrMagnitude>=Vector3.kEpsilonNormalSqrt then local cz=Vector3.Project(cy,cx)if cz.sqrMagnitude>=Vector3.kEpsilonNormalSqrt then local cA=Quaternion.__new(cz.x,cz.y,cz.z,cs.w)cA.Normalize()return cA else return Quaternion.AngleAxis(0,cx)end else local cB=o.QuaternionToAngleAxis(cs)return Quaternion.AngleAxis(cB,cx)end end,ApplyQuaternionToVector3=function(cs,cC)local cD=cs.w*cC.x+cs.y*cC.z-cs.z*cC.y;local cE=cs.w*cC.y-cs.x*cC.z+cs.z*cC.x;local cF=cs.w*cC.z+cs.x*cC.y-cs.y*cC.x;local cG=-cs.x*cC.x-cs.y*cC.y-cs.z*cC.z;return Vector3.__new(cG*-cs.x+cD*cs.w+cE*-cs.z-cF*-cs.y,cG*-cs.y-cD*-cs.z+cE*cs.w+cF*-cs.x,cG*-cs.z+cD*-cs.y-cE*-cs.x+cF*cs.w)end,RotateAround=function(cH,cI,cJ,cK)return cJ+cK*(cH-cJ),cK*cI end,Random32=function()return bit32.band(math.random(-2147483648,2147483646)+2147483648,0xFFFFFFFF)end,RandomUUID=function()return o.UUIDFromNumbers(o.Random32(),bit32.bor(0x4000,bit32.band(o.Random32(),0xFFFF0FFF)),bit32.bor(0x80000000,bit32.band(o.Random32(),0x3FFFFFFF)),o.Random32())end,UUIDString=function(cL)return a8.__tostring(cL)end,UUIDFromNumbers=function(...)local cM=...local b_=type(cM)local cN,cO,cP,cQ;if b_=='table'then cN=cM[1]cO=cM[2]cP=cM[3]cQ=cM[4]else cN,cO,cP,cQ=...end;local cL={bit32.band(cN or 0,0xFFFFFFFF),bit32.band(cO or 0,0xFFFFFFFF),bit32.band(cP or 0,0xFFFFFFFF),bit32.band(cQ or 0,0xFFFFFFFF)}setmetatable(cL,a8)return cL end,UUIDFromString=function(v)local aA=string.len(v)if aA==32 then local cL=o.UUIDFromNumbers(0,0,0,0)for a6=1,4 do local B=1+(a6-1)*8;if not o.StringStartsWith(v,f,B)then return nil end;cL[a6]=tonumber(string.sub(v,B,B+7),16)end;return cL elseif aA==36 then if not o.StringStartsWith(v,f,1)then return nil end;local cN=tonumber(string.sub(v,1,8),16)if not o.StringStartsWith(v,'-',9)or not o.StringStartsWith(v,e,10)or not o.StringStartsWith(v,'-',14)or not o.StringStartsWith(v,e,15)then return nil end;local cO=tonumber(string.sub(v,10,13)..string.sub(v,15,18),16)if not o.StringStartsWith(v,'-',19)or not o.StringStartsWith(v,e,20)or not o.StringStartsWith(v,'-',24)or not o.StringStartsWith(v,e,25)then return nil end;local cP=tonumber(string.sub(v,20,23)..string.sub(v,25,28),16)if not o.StringStartsWith(v,f,29)then return nil end;local cQ=tonumber(string.sub(v,29),16)return o.UUIDFromNumbers(cN,cO,cP,cQ)else return nil end end,ParseUUID=function(v)return o.UUIDFromString(v)end,CreateCircularQueue=function(cR)if type(cR)~='number'or cR<1 then error('CreateCircularQueue: Invalid argument: capacity = '..tostring(cR),2)end;local self;local cS=math.floor(cR)local aC={}local cT=0;local cU=0;local cV=0;self={Size=function()return cV end,Clear=function()cT=0;cU=0;cV=0 end,IsEmpty=function()return cV==0 end,Offer=function(cW)aC[cT+1]=cW;cT=(cT+1)%cS;if cV<cS then cV=cV+1 else cU=(cU+1)%cS end;return true end,OfferFirst=function(cW)cU=(cS+cU-1)%cS;aC[cU+1]=cW;if cV<cS then cV=cV+1 else cT=(cS+cT-1)%cS end;return true end,Poll=function()if cV==0 then return nil else local cW=aC[cU+1]cU=(cU+1)%cS;cV=cV-1;return cW end end,PollLast=function()if cV==0 then return nil else cT=(cS+cT-1)%cS;local cW=aC[cT+1]cV=cV-1;return cW end end,Peek=function()if cV==0 then return nil else return aC[cU+1]end end,PeekLast=function()if cV==0 then return nil else return aC[(cS+cT-1)%cS+1]end end,Get=function(cX)if cX<1 or cX>cV then o.LogError('CreateCircularQueue.Get: index is outside the range: '..cX)return nil end;return aC[(cU+cX-1)%cS+1]end,IsFull=function()return cV>=cS end,MaxSize=function()return cS end}return self end,DetectClicks=function(cY,cZ,c_)local bL=cY or 0;local d0=c_ or TimeSpan.FromMilliseconds(500)local d1=vci.me.Time;local d2=cZ and d1>cZ+d0 and 1 or bL+1;return d2,d1 end,ColorRGBToHSV=function(d3)local d4,al,d5,an=Color.RGBToHSV(d3)return al,d5,an end,ColorFromARGB32=function(d6)local d7=type(d6)=='number'and d6 or 0xFF000000;return Color.__new(bit32.band(bit32.rshift(d7,16),0xFF)/0xFF,bit32.band(bit32.rshift(d7,8),0xFF)/0xFF,bit32.band(d7,0xFF)/0xFF,bit32.band(bit32.rshift(d7,24),0xFF)/0xFF)end,ColorToARGB32=function(d3)return bit32.bor(bit32.lshift(bit32.band(o.Round(0xFF*d3.a),0xFF),24),bit32.lshift(bit32.band(o.Round(0xFF*d3.r),0xFF),16),bit32.lshift(bit32.band(o.Round(0xFF*d3.g),0xFF),8),bit32.band(o.Round(0xFF*d3.b),0xFF))end,
ColorFromIndex=function(d8,d9,da,db,dc)local dd=math.max(math.floor(d9 or o.ColorHueSamples),1)local de=dc and dd or dd-1;local df=math.max(math.floor(da or o.ColorSaturationSamples),1)local dg=math.max(math.floor(db or o.ColorBrightnessSamples),1)local cX=o.Clamp(math.floor(d8 or 0),0,dd*df*dg-1)local dh=cX%dd;local di=math.floor(cX/dd)local B=di%df;local dj=math.floor(di/df)if dc or dh~=de then local al=dh/de;local d5=(df-B)/df;local an=(dg-dj)/dg;return Color.HSVToRGB(al,d5,an)else local an=(dg-dj)/dg*B/(df-1)return Color.HSVToRGB(0.0,0.0,an)end end,ColorToIndex=function(d3,d9,da,db,dc)local dd=math.max(math.floor(d9 or o.ColorHueSamples),1)local de=dc and dd or dd-1;local df=math.max(math.floor(da or o.ColorSaturationSamples),1)local dg=math.max(math.floor(db or o.ColorBrightnessSamples),1)local al,d5,an=o.ColorRGBToHSV(d3)local B=o.Round(df*(1.0-d5))if dc or B<df then local dk=o.Round(de*al)if dk>=de then dk=0 end;if B>=df then B=df-1 end;local dj=math.min(dg-1,o.Round(dg*(1.0-an)))return dk+dd*(B+df*dj)else local dl=o.Round((df-1)*an)if dl==0 then local dm=o.Round(dg*(1.0-an))if dm>=dg then return dd-1 else return dd*(1+o.Round(an*(df-1)/(dg-dm)*dg)+df*dm)-1 end else return dd*(1+dl+df*o.Round(dg*(1.0-an*(df-1)/dl)))-1 end end end,ColorToTable=function(d3)return d3 and{[o.TypeParameterName]=o.ColorTypeName,r=d3.r,g=d3.g,b=d3.b,a=d3.a}or nil end,ColorFromTable=function(ap)local L,av=ao(ap,o.ColorTypeName)return L and Color.__new(ap.r,ap.g,ap.b,ap.a)or nil,av end,Vector2ToTable=function(a9)return a9 and{[o.TypeParameterName]=o.Vector2TypeName,x=a9.x,y=a9.y}or nil end,Vector2FromTable=function(ap)local L,av=ao(ap,o.Vector2TypeName)return L and Vector2.__new(ap.x,ap.y)or nil,av end,Vector3ToTable=function(a9)return a9 and{[o.TypeParameterName]=o.Vector3TypeName,x=a9.x,y=a9.y,z=a9.z}or nil end,Vector3FromTable=function(ap)local L,av=ao(ap,o.Vector3TypeName)return L and Vector3.__new(ap.x,ap.y,ap.z)or nil,av end,Vector4ToTable=function(a9)return a9 and{[o.TypeParameterName]=o.Vector4TypeName,x=a9.x,y=a9.y,z=a9.z,w=a9.w}or nil end,Vector4FromTable=function(ap)local L,av=ao(ap,o.Vector4TypeName)return L and Vector4.__new(ap.x,ap.y,ap.z,ap.w)or nil,av end,QuaternionToTable=function(a9)return a9 and{[o.TypeParameterName]=o.QuaternionTypeName,x=a9.x,y=a9.y,z=a9.z,w=a9.w}or nil end,QuaternionFromTable=function(ap)local L,av=ao(ap,o.QuaternionTypeName)return L and Quaternion.__new(ap.x,ap.y,ap.z,ap.w)or nil,av end,TableToSerializable=function(aI)return aH(aI)end,TableFromSerializable=function(aK,aP)return aO(aK,aP)end,TableToSerialiable=function(aI)return aH(aI)end,TableFromSerialiable=function(aK,aP)return aO(aK,aP)end,EmitMessage=function(bb,b8)vci.message.Emit(bb,b7(b8))end,EmitMessageTo=function(bb,b8,dn)if dn~=nil and dn~=''then vci.message.EmitWithId(bb,b7(b8),dn)else o.LogWarn('EmitMessageTo: targetID is not specified: '..tostring(dn))end end,EmitInstanceMessage=function(bb,b8)o.EmitMessageTo(bb,b8,o.InstanceID())end,OnMessage=function(bb,bh)local a_=function(b1,bk,bc)if type(bc)=='string'and string.startsWith(bc,'{')then local dp,aK=pcall(json.parse,bc)if dp and type(aK)=='table'and aK[o.InstanceIDParameterName]then local dq=o.TableFromSerializable(aK)bh(b0(b1,dq[o.MessageSenderOverride]),bk,dq)return end end;bh(b1,bk,{[o.MessageValueParameterName]=bc})end;vci.message.On(bb,a_)return{Off=function()if a_ then a_=nil end end}end,OnInstanceMessage=function(bb,bh)local a_=function(b1,bk,b8)local b9=o.InstanceID()if b9~=''and b9==b8[o.InstanceIDParameterName]then bh(b1,bk,b8)end end;return o.OnMessage(bb,a_)end,EmitCommentMessage=function(bc,b2)ba(o.DedicatedCommentMessageName,bc,b2,'comment')end,OnCommentMessage=function(bh)return bf(o.DedicatedCommentMessageName,'comment',bh)end,EmitNotificationMessage=function(bc,b2)ba(o.DedicatedNotificationMessageName,bc,b2,'notification')end,OnNotificationMessage=function(bh)return bf(o.DedicatedNotificationMessageName,'notification',bh)end,GetEffekseerEmitterMap=function(bb)local dr=vci.assets.GetEffekseerEmitters(bb)if not dr then return nil end;local ce={}for a6,ds in pairs(dr)do ce[ds.EffectName]=ds end;return ce end,GetAudioSourceMap=function(dt)local ce={}for d4,du in pairs(dt.GetAudioSources()or{})do ce[du.ClipName or'']=du end;return ce end,ParseTagString=function(v)local bM=string.find(v,'#',1,true)if not bM then return{},v end;local dv={}local dw=string.sub(v,1,bM-1)bM=bM+1;local aA=string.len(v)while bM<=aA do local dx,dy=o.StringStartsWith(v,g,bM)if dx then local dz=bM+dy;local dA=string.sub(v,bM,dz-1)local dB=dA;bM=dz;if bM<=aA and o.StringStartsWith(v,'=',bM)then bM=bM+1;local dC,dD=o.StringStartsWith(v,g,bM)if dC then local dE=bM+dD;dB=string.sub(v,bM,dE-1)bM=dE else dB=''end end;dv[dA]=dB end;bM=string.find(v,'#',bM,true)if not bM then break end;bM=bM+1 end;return dv,dw end,CalculateSIPrefix=(function()local dF=9;local dG={'y','z','a','f','p','n','u','m','','k','M','G','T','P','E','Z','Y'}local dH=#dG;return function(ch)local dI=ch==0 and 0 or o.Clamp(math.floor(math.log(math.abs(ch),1000)),1-dF,dH-dF)return dI==0 and ch or ch/1000^dI,dG[dF+dI],dI*3 end end)(),LspContainer=(function()local dJ=nil;local dK='137a14de-3cbe-48fe-8c5f-7226dce4db01'local dL=function()local dM=_ENV['_G']if type(dM)=='table'then dM[dK]=false;local dN=type(dM[dK])=='boolean'dM[dK]=nil;return dN and dM or nil else return nil end end;local dO=function()local dM=_ENV['package']if type(dM)=='table'then local dP=dM[dK]if type(dP)=='table'then return dP else dM[dK]={}return dM[dK]end else return nil end end;local dQ=function()local dM=_ENV;local dP=dM[dK]if type(dP)=='table'then return dP else dM[dK]={}return dM[dK]end end;local dR=function()local dS,dT=pcall(dL)if dS and dT then return dT else local dU,dV=pcall(dO)if dU and dV then return dV else return dQ()end end end;return function()if not dJ then dJ=dR()end;return dJ end end)(),CreateLocalSharedProperties=function(dW,dX)local dY=TimeSpan.FromSeconds(5)local dZ='33657f0e-7c44-4ee7-acd9-92dd8b8d807a'local d_='__CYTANB_LOCAL_SHARED_PROPERTIES_LISTENER_MAP'if type(dW)~='string'or string.len(dW)<=0 or type(dX)~='string'or string.len(dX)<=0 then error('LocalSharedProperties: Invalid arguments',2)end;local e0=o.LspContainer()local e1=e0[dZ]if not e1 then e1={}e0[dZ]=e1 end;e1[dX]=vci.me.UnscaledTime;local e2=e0[dW]if not e2 then e2={[d_]={}}e0[dW]=e2 end;local e3=e2[d_]local self;self={GetLspID=function()return dW end,GetLoadID=function()return dX end,GetProperty=function(ai,bn)local a9=e2[ai]if a9==nil then return bn else return a9 end end,SetProperty=function(ai,a9)if ai==d_ then error('LocalSharedProperties: Invalid argument: key = ',ai,2)end;local d1=vci.me.UnscaledTime;local e4=e2[ai]e2[ai]=a9;for e5,b9 in pairs(e3)do local b_=e1[b9]if b_ and b_+dY>=d1 then e5(self,ai,a9,e4)else e5(self,o.LOCAL_SHARED_PROPERTY_EXPIRED_KEY,true,false)e3[e5]=nil;e1[b9]=nil end end end,Clear=function()for ai,a9 in pairs(e2)do if ai~=d_ then self.SetProperty(ai,nil)end end end,Each=function(bh)for ai,a9 in pairs(e2)do if ai~=d_ and bh(a9,ai,self)==false then return false end end end,AddListener=function(e5)e3[e5]=dX end,RemoveListener=function(e5)e3[e5]=nil end,UpdateAlive=function()e1[dX]=vci.me.UnscaledTime end}return self end,
EstimateFixedTimestep=function(e6,e7)local e8=e7 or{}local e9=e8.mass or 1;if e9<=0 then error('EstimateFixedTimestep: Invalid argument: mass <= 0',2)end;local ea=e8.acceleration or 1000;if ea<=0 then error('EstimateFixedTimestep: Invalid argument: acceleration <= 0',2)end;local eb=e8.startCalcTime or TimeSpan.FromSeconds(5)local ec=e8.stopCalcTime or TimeSpan.FromSeconds(30)if eb<TimeSpan.Zero or eb>ec then error('EstimateFixedTimestep: Invalid argument: startCalcTime < Zero or startCalcTime > stopCalcTime',2)end;local ed=e8.minCalcInterval or TimeSpan.MaxValue;local ee=e8.maxCalcInterval or TimeSpan.MaxValue;if ed<=TimeSpan.Zero or ed>ee then error('EstimateFixedTimestep: Invalid argument: minCalcInterval <= Zero or minCalcInterval > maxCalcInterval',2)end;local ef=ed;local eg=ed<TimeSpan.MaxValue;local eh=e8.defaultTimestep or TimeSpan.FromSeconds(0.02)local ei=eh;if eh<=TimeSpan.Zero then error('EstimateFixedTimestep: Invalid argument: timestep <= Zero',2)end;local ej=0xFFFF;local ek=ej;local el=ej;local em=o.CreateCircularQueue(e8.queueSize or 64)if em.MaxSize()<=1 then error('EstimateFixedTimestep: Invalid argument: queueSize <= 1',2)end;local en=vci.me.Time;local eo=en;local ep=en;local eq=o.Random32()local er=Vector3.__new(bit32.bor(0x100,bit32.band(eq,0x3F)),bit32.bor(0x100,bit32.band(bit32.rshift(eq,8),0x3F)),0)local es=1;local et=function(ck,cl)local eu=ck==ed and 120 or 1200;local cu=ck.TotalSeconds;return TimeSpan.FromSeconds(math.min(cu+math.random()*math.min(eu,cl.TotalSeconds-cu),TimeSpan.MaxValue.TotalSeconds-1))end;local ev={function()em.Clear()e6.SetPosition(er)e6.SetRotation(Quaternion.identity)e6.SetVelocity(Vector3.zero)e6.SetAngularVelocity(Vector3.zero)es=es+1;return eh end,function()e6.AddForce(Vector3.__new(0.0,0.0,e9*ea))en=vci.me.Time;ep=en;es=es+1;return eh end,function()local ew=ep;ep=vci.me.Time;local ex=ew-en;local ey=ex.TotalSeconds;if ey<=1E-10 then return eh end;local ez=e6.GetPosition().z-er.z;local eA=ez/ey/ea;if eA<=1E-10 then return eh end;em.Offer(eA)local eB=em.Size()if eB>=2 and ex>=eb then local eC=0.0;for a6=1,eB do eC=eC+em.Get(a6)end;local eD=eC/eB;local eE=0.0;for a6=1,eB do eE=eE+(em.Get(a6)-eD)^2 end;local eF=eE/eB;if eF<el then el=eF;ei=TimeSpan.FromSeconds(eD)eo=ew end;if ex>ec then if math.abs((ei-eh).TotalSeconds)>=0.001 or el<ek then eh=ei;ek=el end;eo=ew;if ef<TimeSpan.MaxValue then ef=et(ef,ee)end;e6.SetPosition(er)e6.SetRotation(Quaternion.identity)e6.SetVelocity(Vector3.zero)e6.SetAngularVelocity(Vector3.zero)es=es+1 end else ei=TimeSpan.FromSeconds(eA)eo=ew end;if ek>=ej then ek=el;eh=ei end;return eh end,function()ep=vci.me.Time;return eh end}local eG=#ev;local self={Timestep=function()return eh end,Precision=function()return ek end,IsFinished=function()return es==eG end,Update=function()if eg and es==eG and ep-ef>=eo then es=1 end;return ev[es]()end}return self end,AlignSubItemOrigin=function(eH,dt,eI)local eJ=eH.GetRotation()if not o.QuaternionApproximatelyEquals(dt.GetRotation(),eJ)then dt.SetRotation(eJ)end;local eK=eH.GetPosition()if not o.VectorApproximatelyEquals(dt.GetPosition(),eK)then dt.SetPosition(eK)end;if eI then dt.SetVelocity(Vector3.zero)dt.SetAngularVelocity(Vector3.zero)end end,CreateSubItemGlue=function()local eL={}local self;self={Contains=function(eM,eN)return o.NillableIfHasValueOrElse(eL[eM],function(bQ)return o.NillableHasValue(bQ[eN])end,function()return false end)end,Add=function(eM,eO,eI)if not eM or not eO then local eP='SubItemGlue.Add: Invalid arguments '..(not eM and', parent = '..tostring(eM)or'')..(not eO and', children = '..tostring(eO)or'')error(eP,2)end;local bQ=o.NillableIfHasValueOrElse(eL[eM],function(eQ)return eQ end,function()local eQ={}eL[eM]=eQ;return eQ end)if type(eO)=='table'then for ai,aW in pairs(eO)do bQ[aW]={velocityReset=not not eI}end else bQ[eO]={velocityReset=not not eI}end end,Remove=function(eM,eN)return o.NillableIfHasValueOrElse(eL[eM],function(bQ)if o.NillableHasValue(bQ[eN])then bQ[eN]=nil;return true else return false end end,function()return false end)end,RemoveParent=function(eM)if o.NillableHasValue(eL[eM])then eL[eM]=nil;return true else return false end end,RemoveAll=function()eL={}return true end,Each=function(bh,eR)return o.NillableIfHasValueOrElse(eR,function(eM)return o.NillableIfHasValue(eL[eM],function(bQ)for eN,e7 in pairs(bQ)do if bh(eN,eM,self)==false then return false end end end)end,function()for eM,bQ in pairs(eL)do if self.Each(bh,eM)==false then return false end end end)end,Update=function(eS)for eM,bQ in pairs(eL)do local eT=eM.GetPosition()local eU=eM.GetRotation()for eN,e7 in pairs(bQ)do if eS or eN.IsMine then if not o.QuaternionApproximatelyEquals(eN.GetRotation(),eU)then eN.SetRotation(eU)end;if not o.VectorApproximatelyEquals(eN.GetPosition(),eT)then eN.SetPosition(eT)end;if e7.velocityReset then eN.SetVelocity(Vector3.zero)eN.SetAngularVelocity(Vector3.zero)end end end end end}return self end,CreateUpdateRoutine=function(eV,eW,eX,eY)return coroutine.wrap(function()local eZ=eY or TimeSpan.FromSeconds(60)local e_=vci.me.UnscaledTime;local f0=e_;local cZ=vci.me.Time;local f1=true;while o.InstanceID()==''or o.OwnID()==''do local f2=vci.me.UnscaledTime;if f2-eZ>e_ then local f3='TIMEOUT: Could not get '..(o.InstanceID()==''and'Instance ID'or'Own ID')o.LogError(f3)if eX then eX(f3)end;return-1 end;f0=f2;cZ=vci.me.Time;f1=false;coroutine.yield(100)end;if f1 then f0=vci.me.UnscaledTime;cZ=vci.me.Time;coroutine.yield(100)end;if eW then eW()end;while true do local d1=vci.me.Time;local f4=d1-cZ;local f2=vci.me.UnscaledTime;local f5=f2-f0;eV(f4,f5)cZ=d1;f0=f2;coroutine.yield(100)end end)end,CreateSlideSwitch=function(f6)local f7=o.NillableValue(f6.colliderItem)local f8=o.NillableValue(f6.baseItem)local f9=o.NillableValue(f6.knobItem)local fa=o.NillableValueOrDefault(f6.minValue,0)local fb=o.NillableValueOrDefault(f6.maxValue,10)if fa>=fb then error('SlideSwitch: Invalid argument: minValue >= maxValue',2)end;local fc=(fa+fb)*0.5;local fd=function(aW)local fe,ff=o.PingPong(aW-fa,fb-fa)return fe+fa,ff end;local a9=fd(o.NillableValueOrDefault(f6.value,0))local fg=o.NillableIfHasValueOrElse(f6.tickFrequency,function(fh)if fh<=0 then error('SlideSwitch: Invalid argument: tickFrequency <= 0',3)end;return math.min(fh,fb-fa)end,function()return(fb-fa)/10.0 end)local fi=o.NillableIfHasValueOrElse(f6.tickVector,function(cw)return Vector3.__new(cw.x,cw.y,cw.z)end,function()return Vector3.__new(0.01,0.0,0.0)end)local fj=fi.magnitude;if fj<Vector3.kEpsilon then error('SlideSwitch: Invalid argument: tickVector is too small',2)end;local fk=o.NillableValueOrDefault(f6.snapToTick,true)local fl=f6.valueTextName;local fm=o.NillableValueOrDefault(f6.valueToText,tostring)local fn=TimeSpan.FromMilliseconds(1000)local fo=TimeSpan.FromMilliseconds(50)local fp=o.NillableValueOrDefault(f6.alignPeriod,TimeSpan.FromMilliseconds(500))local fq,fr;local e3={}local self;local fs=false;local ft=0;local fu=false;local fv=TimeSpan.Zero;local fw=TimeSpan.Zero;local fx=TimeSpan.Zero;local fy=function(fz,fA)f9.SetLocalPosition((fz-fc)/fg*fi)if fl then vci.assets.SetText(fl,fm(fz,self))end;if fA or fz~=a9 then local e4=a9;a9=fz;for e5,an in pairs(e3)do e5(self,a9,e4)end end end;local fB=function()local fC=fq()local fD,fE=fd(fC)local fF=fC+fg;local fG,fH=fd(fF)assert(fG)local fz;if fE==fH or fD==fb or fD==fa then fz=fF else fz=fE>=0 and fb or fa end;fw=vci.me.UnscaledTime;if fz==fb or fz==fa then fv=fw end;fr(fz)end;o.NillableIfHasValueOrElse(f6.lsp,function(fI)if not o.NillableHasValue(f6.propertyName)then error('SlideSwitch: Invalid argument: propertyName is nil',3)end;local fJ=o.NillableValue(f6.propertyName)fq=function()return fI.GetProperty(fJ,a9)end;fr=function(aW)fI.SetProperty(fJ,aW)end;fI.AddListener(function(bR,ai,fK,fL)if ai==fJ then fy(fd(fK),true)end end)end,function()local fK=a9;fq=function()return fK end;fr=function(aW)fK=aW;fy(fd(aW),true)end end)self={GetColliderItem=function()return f7 end,GetBaseItem=function()return f8 end,GetKnobItem=function()return f9 end,GetMinValue=function()return fa end,GetMaxValue=function()return fb end,GetValue=function()return a9 end,GetScaleValue=function(fM,fN)assert(fM<=fN)return fM+(fN-fM)*(a9-fa)/(fb-fa)end,SetValue=function(aW)fr(fd(aW))end,GetTickFrequency=function()return fg end,IsSnapToTick=function()return fk end,AddListener=function(e5)e3[e5]=e5 end,RemoveListener=function(e5)e3[e5]=nil end,DoUse=function()if not fs then fu=true;fv=vci.me.UnscaledTime;fB()end end,DoUnuse=function()fu=false end,DoGrab=function()if not fu then fs=true;ft=(a9-fc)/fg end end,DoUngrab=function()fs=false end,Update=function()if fs then if f7.IsMine then local fO=f7.GetPosition()-f8.GetPosition()local fP=f9.GetRotation()*fi;local fQ=Vector3.Project(fO,fP)local fR=(Vector3.Dot(fP,fQ)>=0 and 1 or-1)*fQ.magnitude/fj+ft;local fS=fR+fc/fg;local fT=(fk and o.Round(fS)or fS)*fg;local fz=o.Clamp(fT,fa,fb)if fz~=a9 then fr(fz)end else fs=false end elseif fu then if f7.IsMine then local fU=vci.me.UnscaledTime;if fU>=fv+fn and fU>=fw+fo then fB()end else fu=false end elseif f7.IsMine then local fU=vci.me.UnscaledTime;if fU-fp>=fx then fx=fU;o.AlignSubItemOrigin(f8,f7)end end end}fy(fd(fq()),false)return self end,
CreateSubItemConnector=function()local fV=function(fW,dt,fX)fW.item=dt;fW.position=dt.GetPosition()fW.rotation=dt.GetRotation()fW.initialPosition=fW.position;fW.initialRotation=fW.rotation;fW.propagation=not not fX;return fW end;local fY=function(fZ)for dt,fW in pairs(fZ)do fV(fW,dt,fW.propagation)end end;local f_=function(q,cK,fW,g0,g1)local fO=q-fW.initialPosition;local g2=cK*Quaternion.Inverse(fW.initialRotation)fW.position=q;fW.rotation=cK;for dt,g3 in pairs(g0)do if dt~=fW.item and(not g1 or g1(g3))then g3.position,g3.rotation=o.RotateAround(g3.initialPosition+fO,g3.initialRotation,q,g2)dt.SetPosition(g3.position)dt.SetRotation(g3.rotation)end end end;local g4={}local g5=true;local g6=false;local self;self={IsEnabled=function()return g5 end,SetEnabled=function(c9)g5=c9;if c9 then fY(g4)g6=false end end,Contains=function(g7)return o.NillableHasValue(g4[g7])end,Add=function(g8,g9)if not g8 then error('SubItemConnector.Add: Invalid argument: subItems = '..tostring(g8),2)end;local ga=type(g8)=='table'and g8 or{g8}fY(g4)g6=false;for aw,dt in pairs(ga)do g4[dt]=fV({},dt,not g9)end end,Remove=function(g7)local L=o.NillableHasValue(g4[g7])g4[g7]=nil;return L end,RemoveAll=function()g4={}return true end,Each=function(bh)for dt,fW in pairs(g4)do if bh(dt,self)==false then return false end end end,GetItems=function()local ga={}for dt,fW in pairs(g4)do table.insert(ga,dt)end;return ga end,Update=function()if not g5 then return end;local gb=false;for dt,fW in pairs(g4)do local bM=dt.GetPosition()local gc=dt.GetRotation()if not o.VectorApproximatelyEquals(bM,fW.position)or not o.QuaternionApproximatelyEquals(gc,fW.rotation)then if fW.propagation then if dt.IsMine then f_(bM,gc,g4[dt],g4,function(g3)if g3.item.IsMine then return true else g6=true;return false end end)gb=true;break else g6=true end else g6=true end end end;if not gb and g6 then fY(g4)g6=false end end}return self end,UnixTime=function(c7)return o.PosixTime(c7)end,GetSubItemTransform=function(g7)local q=g7.GetPosition()local cK=g7.GetRotation()local gd=g7.GetLocalScale()return{positionX=q.x,positionY=q.y,positionZ=q.z,rotationX=cK.x,rotationY=cK.y,rotationZ=cK.z,rotationW=cK.w,scaleX=gd.x,scaleY=gd.y,scaleZ=gd.z}end}o.SetConstEach(o,{LogLevelOff=0,LogLevelFatal=100,LogLevelError=200,LogLevelWarn=300,LogLevelInfo=400,LogLevelDebug=500,LogLevelTrace=600,LogLevelAll=0x7FFFFFFF,ColorHueSamples=10,ColorSaturationSamples=4,ColorBrightnessSamples=5,EscapeSequenceTag='#__CYTANB',SolidusTag='#__CYTANB_SOLIDUS',NegativeNumberTag='#__CYTANB_NEGATIVE_NUMBER',ArrayNumberTag='#__CYTANB_ARRAY_NUMBER',InstanceIDParameterName='__CYTANB_INSTANCE_ID',MessageValueParameterName='__CYTANB_MESSAGE_VALUE',MessageSenderOverride='__CYTANB_MESSAGE_SENDER_OVERRIDE',MessageOriginalSender='__CYTANB_MESSAGE_ORIGINAL_SENDER',TypeParameterName='__CYTANB_TYPE',ColorTypeName='Color',Vector2TypeName='Vector2',Vector3TypeName='Vector3',Vector4TypeName='Vector4',QuaternionTypeName='Quaternion',DedicatedCommentMessageName='cytanb.comment.a2a6a035-6b8d-4e06-b4f9-07e6209b0639',DedicatedNotificationMessageName='cytanb.notification.698ba55f-2b69-47f2-a68d-bc303994cff3',InstanceIDStatePatchingMessageName='cytanb.instance_id_state_patching.08504824-2041-42a2-9b2a-97448b4418b0',LOCAL_SHARED_PROPERTY_EXPIRED_KEY='__CYTANB_LOCAL_SHARED_PROPERTY_EXPIRED'})o.SetConstEach(o,{ColorMapSize=o.ColorHueSamples*o.ColorSaturationSamples*o.ColorBrightnessSamples,FatalLogLevel=o.LogLevelFatal,ErrorLogLevel=o.LogLevelError,WarnLogLevel=o.LogLevelWarn,InfoLogLevel=o.LogLevelInfo,DebugLogLevel=o.LogLevelDebug,TraceLogLevel=o.LogLevelTrace})b=o.MakeSearchPattern({'\t','\n','\v','\f','\r',' '},1,-1)c=o.MakeSearchPattern({'sprite=','SPRITE='})d=o.MakeSearchPattern({'0','1','2','3','4','5','6','7','8','9'},1,9)e,f=(function()local ge={'A','B','C','D','E','F','a','b','c','d','e','f','0','1','2','3','4','5','6','7','8','9'}return o.MakeSearchPattern(ge,4,4),o.MakeSearchPattern(ge,8,8)end)()g=o.MakeSearchPattern({'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z','a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z','0','1','2','3','4','5','6','7','8','9','_','-','.','(',')','!','~','*','\'','%'},1,-1)h={{tag=o.NegativeNumberTag,search=o.NegativeNumberTag,replacement=''},{tag=o.ArrayNumberTag,search=o.ArrayNumberTag,replacement=''},{tag=o.SolidusTag,search=o.SolidusTag,replacement='/'},{tag=o.EscapeSequenceTag,search=o.EscapeSequenceTag..o.EscapeSequenceTag,replacement=o.EscapeSequenceTag}}i={[o.ColorTypeName]={compositionFieldNames=o.ListToMap({'r','g','b','a'}),compositionFieldLength=4,toTableFunc=o.ColorToTable,fromTableFunc=o.ColorFromTable},[o.Vector2TypeName]={compositionFieldNames=o.ListToMap({'x','y'}),compositionFieldLength=2,toTableFunc=o.Vector2ToTable,fromTableFunc=o.Vector2FromTable},[o.Vector3TypeName]={compositionFieldNames=o.ListToMap({'x','y','z'}),compositionFieldLength=3,toTableFunc=o.Vector3ToTable,fromTableFunc=o.Vector3FromTable},[o.Vector4TypeName]={compositionFieldNames=o.ListToMap({'x','y','z','w'}),compositionFieldLength=4,toTableFunc=o.Vector4ToTable,fromTableFunc=o.Vector4FromTable},[o.QuaternionTypeName]={compositionFieldNames=o.ListToMap({'x','y','z','w'}),compositionFieldLength=4,toTableFunc=o.QuaternionToTable,fromTableFunc=o.QuaternionFromTable}}j=o.ListToMap({o.NegativeNumberTag,o.ArrayNumberTag})k=o.LogLevelInfo;m={[o.LogLevelFatal]='FATAL',[o.LogLevelError]='ERROR',[o.LogLevelWarn]='WARN',[o.LogLevelInfo]='INFO',[o.LogLevelDebug]='DEBUG',[o.LogLevelTrace]='TRACE'}return o end;if __CYTANB_EXPORT_MODULE then return setmetatable({},{__call=function(self,gf)return a(gf)end})else return a(_ENV)end end)()if __CYTANB_EXPORT_MODULE then return cytanb end
